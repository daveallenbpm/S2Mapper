{
  "stage" : "batch",
  "steps": [
    {
      "description":"Find the tubes by barcodes for tube 1...",
      "method":"post",
      "url":"/searches",
      "request":{
        "search":{
          "user":"username",
          "description":"search for barcoded tube",
          "model":"tube",
          "criteria":{
            "label":{
              "position":"barcode",
              "type":"ean13-barcode",
              "value":"tube1_BC"
            }
          }
        }
      },
      "response":{
        "search":{
          "actions":{
            "read":"http://localhost:9292/46ff7c00-68ac-0130-7ac8-282066132de2",
            "first":"http://localhost:9292/46ff7c00-68ac-0130-7ac8-282066132de2/page=1",
            "last":"http://localhost:9292/46ff7c00-68ac-0130-7ac8-282066132de2/page=-1"
          },
          "uuid":"46ff7c00-68ac-0130-7ac8-282066132de2"
        }
      }
    },
  {
      "description":"Get the search results (tubes 1)",
      "method":"get",
      "url":"/46ff7c00-68ac-0130-7ac8-282066132de2/page=1",
      "request":null,
      "response":{
        "actions":{
          "read":"http://localhost:9292/tubes/page=1",
          "first":"http://localhost:9292/tubes/page=1",
          "last":"http://localhost:9292/tubes/page=-1"
        },
        "size":1,
        "tubes":[
          {
              "actions":{
                "read":"http://localhost:9292/tube1_UUID",
                "create":"http://localhost:9292/tube1_UUID",
                "update":"http://localhost:9292/tube1_UUID",
                "delete":"http://localhost:9292/tube1_UUID"
              },
              "uuid":"tube1_UUID",
              "type":null,
              "max_volume":null,
              "aliquots":[
                {
                  "sample":{
                    "actions":{
                      "read":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2",
                      "create":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2",
                      "update":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2",
                      "delete":"http://localhost:9292/472fc450-68ac-0130-7ac8-282066132de2"
                    },
                    "uuid":"472fc450-68ac-0130-7ac8-282066132de2",
                    "name":"sample_0"
                  },
                  "quantity":1000,
                  "type":"NA+P",
                  "unit":"mole"
                }
              ],
              "labels":{
                "actions":{
                  "read":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2",
                  "create":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2",
                  "update":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2",
                  "delete":"http://localhost:9292/3bcf91e0-68ac-0130-9163-282066132de2"
                },
                "uuid":"3bcf91e0-68ac-0130-9163-282066132de2",
                "barcode":{
                  "value":"tube1_BC",
                  "type":"ean13-barcode"
                }
              }
          }
        ]
      }
    },
    {
      "description":"Find the order by tube uuid and role for tube 1",
      "method":"post",
      "url":"/searches",
      "request":{
        "search":{
          "user":"username",
          "description":"search for order",
          "model":"order",
          "criteria":{
            "item":{
              "uuid":"tube1_UUID"
            }
          }
        }
      },
      "response":{
        "search":{
          "actions":{
            "read":"http://localhost:9292/473203b0-68ac-0130-7ac8-282066132de2",
            "first":"http://localhost:9292/473203b0-68ac-0130-7ac8-282066132de2/page=1",
            "last":"http://localhost:9292/473203b0-68ac-0130-7ac8-282066132de2/page=-1"
          },
          "uuid":"473203b0-68ac-0130-7ac8-282066132de2"
        }
      }
    },
    {
      "description":"Find the tubes by barcodes for tube 2...",
      "method":"post",
      "url":"/searches",
      "request":{
        "search":{
          "user":"username",
          "description":"search for barcoded tube",
          "model":"tube",
          "criteria":{
            "label":{
              "position":"barcode",
              "type":"ean13-barcode",
              "value":"tube2_BC"
            }
          }
        }
      },
      "response":{
        "search":{
          "actions":{
            "read":"http://localhost:9292/46ff7c00-0000-0000-7ac8-282066132de2",
            "first":"http://localhost:9292/46ff7c00-0000-0000-7ac8-282066132de2/page=1",
            "last":"http://localhost:9292/46ff7c00-0000-0000-7ac8-282066132de2/page=-1"
          },
          "uuid":"46ff7c00-0000-0000-7ac8-282066132de2"
        }
      }
    },
  {
      "description":"Get the search results (tubes 2)",
      "method":"get",
      "url":"/46ff7c00-0000-0000-7ac8-282066132de2/page=1",
      "request":null,
      "response":{
        "actions":{
          "read":"http://localhost:9292/tubes/page=1",
          "first":"http://localhost:9292/tubes/page=1",
          "last":"http://localhost:9292/tubes/page=-1"
        },
        "size":1,
        "tubes":[
          {
              "actions":{
                "read":"http://localhost:9292/tube2_UUID",
                "create":"http://localhost:9292/tube2_UUID",
                "update":"http://localhost:9292/tube2_UUID",
                "delete":"http://localhost:9292/tube2_UUID"
              },
              "uuid":"tube2_UUID",
              "type":null,
              "max_volume":null,
              "aliquots":[
                {
                  "sample":{
                    "actions":{
                      "read":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2",
                      "create":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2",
                      "update":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2",
                      "delete":"http://localhost:9292/472fc450-0000-0130-7ac8-282066132de2"
                    },
                    "uuid":"472fc450-0000-0130-7ac8-282066132de2",
                    "name":"sample_0"
                  },
                  "quantity":1000,
                  "type":"NA+P",
                  "unit":"mole"
                }
              ],
              "labels":{
                "actions":{
                  "read":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2",
                  "create":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2",
                  "update":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2",
                  "delete":"http://localhost:9292/3bcf91e0-0000-0130-9163-282066132de2"
                },
                "uuid":"3bcf91e0-0000-0130-9163-282066132de2",
                "barcode":{
                  "value":"tube2_BC",
                  "type":"ean13-barcode"
                }
              }
          }
        ]
      }
    },
    {
      "description":"Find the order by tube uuid and role for tube 2",
      "method":"post",
      "url":"/searches",
      "request":{
        "search":{
          "user":"username",
          "description":"search for order",
          "model":"order",
          "criteria":{
            "item":{
              "uuid":"tube2_UUID"
            }
          }
        }
      },
      "response":{
        "search":{
          "actions":{
            "read":"http://localhost:9292/473203b0-0000-0000-7ac8-282066132de2",
            "first":"http://localhost:9292/473203b0-0000-0000-7ac8-282066132de2/page=1",
            "last":"http://localhost:9292/473203b0-0000-0000-7ac8-282066132de2/page=-1"
          },
          "uuid":"473203b0-0000-0000-7ac8-282066132de2"
        }
      }
    },

    {
      "description":"Get the search results (order 1)",
      "method":"get",
      "url":"/473203b0-68ac-0130-7ac8-282066132de2/page=1",
      "request":null,
      "response":{
        "actions":{
          "read":"http://localhost:9292/orders/page=1",
          "first":"http://localhost:9292/orders/page=1",
          "last":"http://localhost:9292/orders/page=-1"
        },
        "size":1,
        "orders":[
          {
            "actions":{
              "read":"http://localhost:9292/order1_UUID",
              "create":"http://localhost:9292/order1_UUID",
              "update":"http://localhost:9292/order1_UUID",
              "delete":"http://localhost:9292/order1_UUID"
            },
            "uuid":"order1_UUID",
            "pipeline":"DNA+RNA manual extraction",
            "status":"draft",
            "parameters":{},
            "state":{},
            "cost_code":"cost code",
            "creator":{
              "actions":{
                "read":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2"
              },
              "uuid":"3bce77b0-68ac-0130-9163-282066132de2"
            },
            "study":{
              "actions":{
                "read":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2"
              },
              "uuid":"3bce8620-68ac-0130-9163-282066132de2"
            },
            "items":{
              "tube_to_be_extracted":[
                {
                "uuid":"tube1_UUID",
                "status":"done",
                "batch":null
              },
              {
                "uuid":"tube3_UUID",
                "status":"done",
                "batch":null
              }
              ]
            }
          }
        ]
      }
    },
    {
      "description":"Get the search results (order 2)",
      "method":"get",
      "url":"/473203b0-0000-0000-7ac8-282066132de2/page=1",
      "request":null,
      "response":{
        "actions":{
          "read":"http://localhost:9292/orders/page=1",
          "first":"http://localhost:9292/orders/page=1",
          "last":"http://localhost:9292/orders/page=-1"
        },
        "size":1,
        "orders":[
          {
            "actions":{
              "read":"http://localhost:9292/order2_UUID",
              "create":"http://localhost:9292/order2_UUID",
              "update":"http://localhost:9292/order2_UUID",
              "delete":"http://localhost:9292/order2_UUID"
            },
            "uuid":"order2_UUID",
            "pipeline":"DNA+RNA manual extraction",
            "status":"draft",
            "parameters":{},
            "state":{},
            "cost_code":"cost code",
            "creator":{
              "actions":{
                "read":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce77b0-68ac-0130-9163-282066132de2"
              },
              "uuid":"3bce77b0-68ac-0130-9163-282066132de2"
            },
            "study":{
              "actions":{
                "read":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "create":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "update":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2",
                "delete":"http://localhost:9292/3bce8620-68ac-0130-9163-282066132de2"
              },
              "uuid":"3bce8620-68ac-0130-9163-282066132de2"
            },
            "items":{
              "tube_to_be_extracted":[
                {
                "uuid":"tube2_UUID",
                "status":"done",
                "batch":null
              },
              {
                "uuid":"tube3_UUID",
                "status":"done",
                "batch":null
              }
              ]
            }
          }
        ]
      }
    },
    {
      "description":"Create a new batch",
      "method":"post",
      "url":"/batches",
      "request": {
        "batch": {
          "user" : "username"
        }
      },
      "response":{
        "batch":{
          "actions":{
            "read":"http://localhost:9292/batch_UUID",
            "create":"http://localhost:9292/batch_UUID",
            "update":"http://localhost:9292/batch_UUID",
            "delete":"http://localhost:9292/batch_UUID"
          },
          "uuid":"batch_UUID",
          "process":null
        }
      }
    }
  ]
}
